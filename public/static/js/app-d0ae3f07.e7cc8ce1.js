!function(e){function t(t){for(var n,r,i=t[0],c=t[1],l=t[2],h=0,p=[];h<i.length;h++)r=i[h],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);p.length;)p.shift()();return a.push.apply(a,l||[]),s()}function s(){for(var e,t=0;t<a.length;t++){for(var s=a[t],n=!0,i=1;i<s.length;i++){var c=s[i];0!==o[c]&&(n=!1)}n&&(a.splice(t--,1),e=r(r.s=s[0]))}return e}var n={},o={"app-d0ae3f07":0},a=[];function r(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=n,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;a.push([0,"chunk-elementUI-59f3426a","chunk-elementUI-4b7bae34","chunk-elementUI-fe785c75","chunk-elementUI-a4592785","chunk-elementUI-2ea58815","chunk-elementUI-62ee4a0c","chunk-vendors-253ae210","chunk-vendors-d939e436","chunk-vendors-b58f7129","chunk-vendors-1c3a2c3f","chunk-vendors-fdc6512a","chunk-vendors-68083780"]),s()}({0:function(e,t,s){e.exports=s("56d7")},"0b68":function(e,t,s){"use strict";s("ad04")},"0fb3":function(e,t,s){"use strict";s("2128")},2128:function(e,t,s){},2379:function(e,t,s){},2897:function(e,t,s){"use strict";s("2379")},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var n=s("2b0e"),o=s("5c96"),a={install:function(e){e.use(o.Input),e.use(o.Dialog),e.use(o.Row),e.use(o.Col),e.use(o.Form),e.use(o.FormItem),e.use(o.Button),e.use(o.ButtonGroup),e.use(o.Table),e.use(o.TableColumn),e.use(o.Container),e.use(o.Header),e.use(o.Main),e.use(o.Upload),e.use(o.Dropdown),e.use(o.DropdownItem),e.use(o.DropdownMenu),e.use(o.Tabs),e.use(o.TabPane),e.use(o.Divider),e.use(o.Tooltip),e.prototype.$message=o.Message}},r=(s("0fae"),s("b20f"),{name:"App"}),i=(s("0b68"),s("2877")),c=Object(i.a)(r,(function(){var e=this._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)}),[],!1,null,null,null).exports,l=s("2f62"),u=s("5530"),h=(s("b64b"),s("a925")),p=s("4897"),d=s.n(p),f=s("b2d6"),m=s.n(f),g=s("f0d9"),v=s.n(g);n.default.use(h.a);var b={en:Object(u.a)(Object(u.a)({},{hostTip:"please input remote host",portTip:"input port",nameTip:"please input username",inputTip:"please input ",keyTip:"please paste privateKey content",wsClose:"websocket connection disconnected!",notCloseWindows:"please do not close windows",unlockClose:"please unlock to close tab",clickSelectFile:"click to select upload file",clickSelectFolder:"click to select upload folder",uploadFinish:" upload finish"}),m.a),zh:Object(u.a)(Object(u.a)({},{OK:"确定",Cancel:"取消",History:"历史记录",Lock:"锁定",Unlock:"解锁",Size:"大小",Name:"名字",Copy:"复制",Upload:"上传",Rename:"重命名",FullScreen:"全屏",Close:"关闭",CloseLeft:"关闭左边",CloseRight:"关闭右边",CloseOther:"关闭其他",CloseAll:"关闭所有",FileBrowser:"文件管理",ModifiedTime:"修改时间",Clear:"清空",Connect:"连接",password:"密码",privateKey:"密钥",hostTip:"请输入远程host地址",portTip:"请输入端口",nameTip:"请输入用户名",inputTip:"请输入",keyTip:"请粘贴私钥内容",SelectFile:"选择文件",wsClose:"websocket连接已断开!",uploadPath:"当前上传目录",uploadFinish:"上传完成",to:"到",uploading:"正在上传",notCloseWindows:"请勿关闭窗口",unlockClose:"请解锁后再来关闭",clickSelectFile:"点击选择文件",clickSelectFolder:"点击选择文件夹",uploadFile:"上传文件",uploadFolder:"上传文件夹"}),v.a)};function w(){var e=localStorage.getItem("language");if(e)return e;for(var t=(navigator.language||navigator.browserLanguage).toLowerCase(),s=0,n=Object.keys(b);s<n.length;s++){var o=n[s];if(t.indexOf(o)>-1)return o}return"zh"}var y=new h.a({locale:w(),messages:b,silentTranslationWarn:!0});d.a.i18n((function(e,t){return y.t(e,t)}));var I=y,S=function(){return{sshInfo:{hostname:"",username:"",port:"",password:"",command:""},sshList:Object.prototype.hasOwnProperty.call(localStorage,"sshList")?localStorage.getItem("sshList"):null,termList:[],currentTab:{},language:w()}},k=(s("e9c4"),s("a9e3"),s("498a"),s("313d"),s("0eb6"),s("b7ef"),s("8bd4"),{sshReq:function(e){var t={hostname:e.sshInfo.hostname,port:Number(e.sshInfo.port),username:e.sshInfo.username,logintype:e.sshInfo.privateKey&&e.sshInfo.privateKey.trim()?1:0};e.sshInfo.password&&(t.password=e.sshInfo.password),e.sshInfo.privateKey&&e.sshInfo.privateKey.trim()&&(t.privateKey=e.sshInfo.privateKey),e.sshInfo.passphrase&&(t.passphrase=e.sshInfo.passphrase);var s=JSON.stringify(t);return window.btoa(s)}}),T={SET_PASS:function(e,t){e.sshInfo.password=t},SET_LIST:function(e,t){e.sshList=t,localStorage.setItem("sshList",t)},SET_TERMLIST:function(e,t){e.termList=t},SET_SSH:function(e,t){e.sshInfo.hostname=t.hostname,e.sshInfo.port=t.port,e.sshInfo.username=t.username,void 0!==t.password&&(e.sshInfo.password=t.password),void 0!==t.command&&(e.sshInfo.command=t.command),void 0!==t.privateKey&&(e.sshInfo.privateKey=t.privateKey),void 0!==t.passphrase&&(e.sshInfo.passphrase=t.passphrase)},SET_TAB:function(e,t){e.currentTab=t},SET_LANGUAGE:function(e,t){e.language=t,localStorage.setItem("language",t)}};n.default.use(l.a);var C=new l.a.Store({state:S,getters:k,mutations:T,actions:{setLanguage:function(e,t){(0,e.commit)("SET_LANGUAGE",t)}}}),_=s("8c4f"),P=(s("14d9"),s("b0c0"),s("d3b7"),s("ac1f"),s("25f0"),s("3ca3"),s("841c"),s("ddb0"),s("2b3d"),s("bf19"),s("9861"),s("88a7"),s("271a"),s("5494"),{data:function(){return{sshInfo:{hostname:"",port:"",username:"",password:"",privateKey:"",passphrase:"",command:""},privateKeyFileName:"",generatedLink:"",isDarkTheme:!1}},watch:{sshInfo:{handler:function(e){localStorage.setItem("sshInfo",JSON.stringify(e))},deep:!0}},created:function(){var e=localStorage.getItem("connectionInfo");if(e){var t=JSON.parse(e);this.sshInfo={hostname:t.hostname||"",port:t.port||"",username:t.username||"",password:t.password||"",privateKey:t.privateKey||"",passphrase:t.passphrase||"",command:t.command||""},t.privateKey&&(this.privateKeyFileName="已保存的密钥文件")}var s=localStorage.getItem("isDarkTheme");null!==s&&(this.isDarkTheme="true"===s);var n=document.createElement("link");n.rel="stylesheet",n.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css",document.head.appendChild(n)},methods:{onConnect:function(){if(sessionStorage.removeItem("sshInfo"),this.sshInfo.hostname&&this.sshInfo.username)if(this.sshInfo.password||this.sshInfo.privateKey){this.sshInfo.privateKey&&this.sshInfo.privateKey.trim()?this.sshInfo.password="":this.sshInfo.password&&(this.sshInfo.privateKey="",this.sshInfo.passphrase="",this.privateKeyFileName="");var e={hostname:this.sshInfo.hostname,port:this.sshInfo.port||22,username:this.sshInfo.username,password:this.sshInfo.password||"",privateKey:this.sshInfo.privateKey||"",passphrase:this.sshInfo.passphrase||"",command:this.sshInfo.command||""};localStorage.setItem("connectionInfo",JSON.stringify(e));var t={hostname:encodeURIComponent(this.sshInfo.hostname),port:Number(this.sshInfo.port)||22,username:encodeURIComponent(this.sshInfo.username),command:encodeURIComponent(this.sshInfo.command||"")};this.sshInfo.privateKey&&this.sshInfo.privateKey.trim()?(sessionStorage.setItem("sshInfo",JSON.stringify(this.sshInfo)),t.useKey=1):this.sshInfo.password&&(t.password=btoa(this.sshInfo.password)),this.$router.push({path:"/terminal",query:t})}else this.$message.error("请输入密码或上传密钥！");else this.$message.error("主机和用户名不能为空！")},onReset:function(){this.sshInfo={hostname:"",port:"",username:"",password:"",command:"",privateKey:"",passphrase:""},this.privateKeyFileName="",this.generatedLink="",localStorage.removeItem("connectionInfo"),sessionStorage.removeItem("sshInfo");var e=document.querySelector('.upload-key input[type="file"]');e&&(e.value="")},onGenerateLink:function(){if(this.sshInfo.privateKey)this.$message.warning("密钥方式登录不支持生成快捷链接，请改用密码登录方式");else if(this.sshInfo.hostname&&this.sshInfo.username){var e=new URL(window.location.href);e.pathname="/terminal";var t={},s=Object(u.a)(Object(u.a)({},this.sshInfo),{},{port:this.sshInfo.port||22});for(var n in s)""!==s[n]&&null!==s[n]&&(t[n]="password"===n?btoa(s[n]):s[n]);e.search=new URLSearchParams(t).toString(),this.generatedLink=e.href}else this.$message.error("请填写主机、用户名和密码以生成链接！")},copyLink:function(){var e=this;this.generatedLink&&navigator.clipboard.writeText(this.generatedLink).then((function(){e.$message.success("链接已复制！")})).catch((function(t){e.$message.error("复制失败: "+t)}))},toggleTheme:function(){this.isDarkTheme=!this.isDarkTheme,localStorage.setItem("isDarkTheme",this.isDarkTheme)},handlePrivateKeyUpload:function(e){var t=this;this.sshInfo.password="";var s=new FileReader;return s.onload=function(s){t.sshInfo.privateKey=s.target.result,t.privateKeyFileName=e.name},s.readAsText(e),!1}}}),L=(s("0fb3"),Object(i.a)(P,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container",class:{"dark-theme":e.isDarkTheme}},[t("div",{staticClass:"theme-switch-wrapper"},[t("div",{staticClass:"theme-switch",on:{click:e.toggleTheme}},[t("i",{staticClass:"fas",class:e.isDarkTheme?"fa-sun":"fa-moon",staticStyle:{"margin-top":"-30px"}})])]),t("div",{staticClass:"card",staticStyle:{margin:"20px auto"}},[t("div",{staticClass:"title"},[e._v("WebSSH Console")]),t("el-form",{staticClass:"form-grid",attrs:{model:e.sshInfo,"label-position":"top"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"主机地址 (Hostname)"}},[t("el-input",{attrs:{placeholder:"请输入主机地址"},model:{value:e.sshInfo.hostname,callback:function(t){e.$set(e.sshInfo,"hostname",t)},expression:"sshInfo.hostname"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"端口 (Port)"}},[t("el-input",{attrs:{placeholder:"请输入端口(默认22)"},model:{value:e.sshInfo.port,callback:function(t){e.$set(e.sshInfo,"port",e._n(t))},expression:"sshInfo.port"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"用户名 (Username)"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.sshInfo.username,callback:function(t){e.$set(e.sshInfo,"username",t)},expression:"sshInfo.username"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"密码 (Password)"}},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码","show-password":""},model:{value:e.sshInfo.password,callback:function(t){e.$set(e.sshInfo,"password",t)},expression:"sshInfo.password"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"私钥 (Private Key)"}},[t("el-upload",{staticClass:"upload-key",attrs:{"show-file-list":!1,"before-upload":e.handlePrivateKeyUpload,accept:".pem,.ppk,.key,.rsa,.id_rsa,.id_dsa,.txt"}},[t("div",{staticClass:"upload-flex-row"},[t("div",{staticClass:"upload-btn"},[t("i",{staticClass:"el-icon-folder-opened",staticStyle:{"margin-right":"8px"}}),e._v(" 上传密钥 ")]),t("div",{staticClass:"upload-filename"},[e._v(" "+e._s(e.privateKeyFileName||"未上传密钥文件")+" ")])])])],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"密钥口令 (PIN)"}},[t("el-input",{attrs:{placeholder:"如果有设置请输入密钥口令"},model:{value:e.sshInfo.passphrase,callback:function(t){e.$set(e.sshInfo,"passphrase",t)},expression:"sshInfo.passphrase"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"初始命令 (Initial command)"}},[t("el-input",{attrs:{placeholder:"登录后要执行的命令"},model:{value:e.sshInfo.command,callback:function(t){e.$set(e.sshInfo,"command",t)},expression:"sshInfo.command"}})],1)],1)],1),t("el-row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"center"}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-refresh"},on:{click:e.onReset}},[e._v("重置输入")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-link"},on:{click:e.onGenerateLink}},[e._v("生成链接")]),t("el-button",{attrs:{type:"success"},on:{click:e.onConnect}},[t("i",{staticClass:"fas fa-terminal",staticStyle:{"margin-right":"6px"}}),e._v("连接SSH")])],1),e.generatedLink?t("el-row",{staticStyle:{"margin-top":"18px"}},[t("el-col",{attrs:{span:24}},[t("el-input",{attrs:{readonly:""},model:{value:e.generatedLink,callback:function(t){e.generatedLink=t},expression:"generatedLink"}},[t("template",{slot:"append"},[t("el-button",{attrs:{icon:"el-icon-document-copy"},on:{click:e.copyLink}})],1)],2)],1)],1):e._e()],1)],1),e._m(0)])}),[function(){var e=this._self._c;return e("div",{staticClass:"footer"},[e("a",{attrs:{href:"https://github.com/eooce/webssh",target:"_blank",rel:"noopener noreferrer"}},[this._v("WebSSH Console | Powered by eooce")])])}],!1,null,"019a6c3a",null).exports),O=(s("81b2"),s("c14f")),$=s("1da1");s("99af"),s("a434"),s("e9f5"),s("7d54"),s("00b4"),s("1e25"),s("159b");var F=s("cee4").a.create({timeout:15e3,baseURL:"/",validateStatus:function(e){switch(e){case 400:o.Message.error("请求出错");break;case 403:o.Message.warning({message:"拒绝访问"});break;case 404:o.Message.warning({message:"请求错误,未找到该资源"});break;case 500:o.Message.warning({message:"服务端错误"})}return e>=200&&e<300}});F.interceptors.response.use((function(e){return e.data}),(function(e){return void 0!==e.response||e.config&&e.config.cancelToken||o.Message.error("连接服务器失败"),Promise.reject(e.response)}));var D=F;function K(e){return D.get("/check?sshInfo=".concat(e))}var x=s("fcf3"),j=s("47d0"),U=s("173c");s("a15b"),s("fb6a"),s("5319");var N={name:"FileList",data:function(){return{uploadVisible:!1,fileList:[],downloadFilePath:"",currentPath:"/",selectTip:"clickSelectFile",titleTip:"uploadFile",uploadTip:"",progressPercent:0,initialRedirectDone:!1,homePath:""}},mounted:function(){this.currentPath&&"/"!==this.currentPath||this.getFileList()},computed:Object(u.a)(Object(u.a)({},Object(l.b)(["currentTab"])),{},{sshInfoReady:function(){return this.$store.state.sshInfo&&this.$store.state.sshInfo.hostname},uploadUrl:function(){return"".concat("".concat(location.origin),"/file/upload")},uploadData:function(){return{sshInfo:this.$store.getters.sshReq,path:this.currentPath}}}),watch:{sshInfoReady:function(e,t){e&&!t&&this.getFileList()},currentTab:function(){this.fileList=[],this.currentPath=this.currentTab&&this.currentTab.path?this.currentTab.path:"/"}},methods:{goToHome:function(){this.homePath?this.currentPath!==this.homePath&&(this.currentPath=this.homePath,this.getFileList()):this.$message.warning("主目录信息尚不可用，请刷新重试。")},openUploadDialog:function(){this.uploadTip="".concat(this.$t("uploadPath"),": ").concat(this.currentPath),this.uploadVisible=!0},handleUploadCommand:function(e){"folder"===e?(this.selectTip="clickSelectFolder",this.titleTip="uploadFolder"):(this.selectTip="clickSelectFile",this.titleTip="uploadFile"),this.openUploadDialog();var t="folder"===e;this.webkitdirectorySupported()?this.$nextTick((function(){var e=document.getElementsByClassName("el-upload__input")[0];e&&(e.webkitdirectory=t)})):t&&this.$message.warning("当前浏览器不支持")},webkitdirectorySupported:function(){return"webkitdirectory"in document.createElement("input")},beforeUpload:function(e){this.uploadTip="".concat(this.$t("uploading")," ").concat(e.name," ").concat(this.$t("to")," ").concat(this.currentPath,", ").concat(this.$t("notCloseWindows"),".."),this.uploadData.id=e.uid;var t=e.webkitRelativePath;return this.uploadData.dir=t?t.substring(0,t.lastIndexOf("/")):"",!0},uploadSuccess:function(e,t){this.uploadTip="".concat(t.name).concat(this.$t("uploadFinish"),"!")},uploadProgress:function(e,t){if(e.percent=e.percent/2,t.percentage=t.percentage/2,50===e.percent){var s=new WebSocket("".concat("http:"===location.protocol?"ws":"wss","://").concat(location.host).concat("","/file/progress?id=").concat(t.uid));s.onmessage=function(e){t.percentage=(t.size+Number(e.data))/(2*t.size)*100},s.onclose=function(){console.log(Date(),"onclose")},s.onerror=function(){console.log(Date(),"onerror")}}},nameSort:function(e,t){return e.Name>t.Name},rowClick:function(e){e.IsDir?(this.currentPath="/"===this.currentPath.charAt(this.currentPath.length-1)?this.currentPath+e.Name:this.currentPath+"/"+e.Name,this.getFileList()):(this.downloadFilePath="/"===this.currentPath.charAt(this.currentPath.length-1)?this.currentPath+e.Name:this.currentPath+"/"+e.Name,this.downloadFile())},getFileList:function(){var e=this;return Object($.a)(Object(O.a)().m((function t(){var s;return Object(O.a)().w((function(t){for(;;)switch(t.n){case 0:return e.currentPath=e.currentPath.replace(/\\+/g,"/"),""===e.currentPath&&(e.currentPath="/"),t.n=1,n=e.currentPath,o=e.$store.getters.sshReq,D.get("/file/list?path=".concat(n,"&sshInfo=").concat(o));case 1:if("success"!==(s=t.v).Msg){t.n=4;break}if(s.Data.home&&(e.homePath=s.Data.home),null===s.Data.list?e.fileList=[]:e.fileList=s.Data.list,e.initialRedirectDone||!s.Data.home||"/"===s.Data.home||e.currentPath===s.Data.home){t.n=3;break}return e.initialRedirectDone=!0,e.currentPath=s.Data.home,t.n=2,e.getFileList();case 2:return t.a(2);case 3:t.n=5;break;case 4:e.fileList=[],e.$message({message:s.Msg,type:"error",duration:3e3});case 5:return t.a(2)}var n,o}),t)})))()},upDirectory:function(){if("/"!==this.currentPath){var e=this.currentPath.split("/");e=""===e[e.length-1]?e.slice(0,e.length-2):e.slice(0,e.length-1),this.currentPath=1===e.length?"/":e.join("/"),this.getFileList()}},downloadFile:function(){var e="".concat(location.origin),t="".concat(e,"/file/download?path=").concat(this.downloadFilePath,"&sshInfo=").concat(this.$store.getters.sshReq);window.open(t)}}},R=(s("feba"),{name:"Terminal",components:{FileList:Object(i.a)(N,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"file-list-wrapper"},[t("div",{staticClass:"sftp-title"},[e._v("SFTP文件管理")]),t("div",{staticClass:"file-header"},[t("el-input",{staticClass:"path-input",attrs:{size:"small",placeholder:"当前路径..."},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getFileList()}},model:{value:e.currentPath,callback:function(t){e.currentPath=t},expression:"currentPath"}}),t("el-button-group",[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-s-home",title:"主目录"},on:{click:function(t){return e.goToHome()}}}),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-arrow-up",title:"返回上级目录"},on:{click:function(t){return e.upDirectory()}}}),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh",title:"刷新当前目录"},on:{click:function(t){return e.getFileList()}}}),t("el-dropdown",{attrs:{size:"small"},on:{click:function(t){return e.openUploadDialog()},command:e.handleUploadCommand}},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-upload"}}),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"file"}},[e._v(e._s(e.$t("uploadFile")))]),t("el-dropdown-item",{attrs:{command:"folder"}},[e._v(e._s(e.$t("uploadFolder")))])],1)],1)],1)],1),t("el-dialog",{attrs:{"custom-class":"uploadContainer",title:e.$t(this.titleTip),visible:e.uploadVisible,"append-to-body":"",width:"32%"},on:{"update:visible":function(t){e.uploadVisible=t}}},[t("el-upload",{ref:"upload",attrs:{multiple:"",drag:"",action:e.uploadUrl,data:e.uploadData,"before-upload":e.beforeUpload,"on-progress":e.uploadProgress,"on-success":e.uploadSuccess}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(e._s(e.$t(this.selectTip)))]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(this.uploadTip))])])],1),t("el-table",{staticClass:"file-table",attrs:{data:e.fileList,height:"100%"},on:{"row-click":e.rowClick}},[t("el-table-column",{attrs:{label:e.$t("Name"),width:"140",sortable:"","sort-method":e.nameSort},scopedSlots:e._u([{key:"default",fn:function(s){return[!0===s.row.IsDir?t("p",{staticClass:"el-icon-folder",staticStyle:{color:"#0c60b5",cursor:"pointer"}},[e._v(" "+e._s(s.row.Name))]):!1===s.row.IsDir?t("p",{staticClass:"el-icon-document",staticStyle:{cursor:"pointer"}},[e._v(" "+e._s(s.row.Name))]):e._e()]}}])}),t("el-table-column",{attrs:{label:e.$t("Size"),prop:"Size",width:"80"}}),t("el-table-column",{attrs:{label:e.$t("ModifiedTime"),prop:"ModifyTime",width:"120",sortable:""}})],1)],1)}),[],!1,null,null,null).exports},data:function(){return{term:null,ws:null,resetClose:!1,ssh:null,savePass:!1,fontSize:15,isSftpVisible:!1}},mounted:function(){var e=this;this.$nextTick((function(){e.createTerm()}))},methods:{toggleSftpPanel:function(){this.isSftpVisible=!this.isSftpVisible},setSSH:function(){this.$store.commit("SET_SSH",this.ssh)},resizeTerm:function(){},createTerm:function(){var e=this,t=this.$store.state.sshInfo;if(!t||!t.hostname)return this.$message.error("无效的连接信息！正在返回登录页..."),void this.$router.push("/");var s=document.getElementById("xterm-container");if(s){var n=this.$store.getters.sshReq;this.close();var o=new j.FitAddon;this.term=new x.Terminal({cursorBlink:!0,cursorStyle:"bar",cursorWidth:4,fontFamily:"DejaVu Sans Mono, monospace",fontSize:this.fontSize,theme:{background:"#000000",foreground:"#ffffff",cursor:"#ffffff",selection:"#acacac7d",blue:"#0950ee",brightMagenta:"#e879f9",brightBlue:"#71afff"}}),this.term.loadAddon(o),this.term.open(document.getElementById("xterm-container")),this.term.focus(),this.term.write("[1;1H[1;32m正在连接，请稍后...[0m\r\n");try{o.fit()}catch(e){}var a=this,r={timeout:5e3,intervalObj:null,stop:function(){clearInterval(this.intervalObj)},start:function(){this.intervalObj=setInterval((function(){null!==a.ws&&1===a.ws.readyState&&a.ws.send("ping")}),this.timeout)}},i="已超时关闭!";"en"===this.$store.state.language&&(i="Connection timed out!"),this.ws=new WebSocket("".concat("http:"===location.protocol?"ws":"wss","://").concat(location.host).concat("","/term?sshInfo=").concat(n,"&rows=").concat(this.term.rows,"&cols=").concat(this.term.cols,"&closeTip=").concat(i)),this.ws.onopen=function(){console.log(Date(),"onopen"),a.connected(),r.start(),a._initCmdSent=!1},this.ws.onmessage=function(e){"string"==typeof e.data&&setTimeout((function(){if(!a._initCmdSent&&a.ssh){var e=a.term;if(!e||!e.buffer||!e.buffer.active)return;var t=e.buffer.active.baseY+e.buffer.active.cursorY,s=e.buffer.active.getLine(t);if(s){var n=s.translateToString();/[>$#%]\s*$/.test(n.trimEnd())&&(a._initCmdSent=!0,a.term.write("[s[1;1H[2K[u"),a.ssh.command&&setTimeout((function(){a.ws&&1===a.ws.readyState&&a.ws.send(a.ssh.command+"\r")}),100))}}}),10)},this.ws.onclose=function(){console.log(Date(),"onclose"),a.resetClose||(a.ssh&&!e.savePass&&(e.$store.commit("SET_PASS",""),a.ssh.password=""),e.$message({message:e.$t("wsClose"),type:"warning",duration:0,showClose:!0}),e.ws=null),r.stop(),a.resetClose=!1,null!==a.ws&&1===a.ws.readyState&&a.ws.send("resize:".concat(a.term.rows,":").concat(a.term.cols))},this.ws.onerror=function(){console.log(Date(),"onerror")};var c=new U.AttachAddon(this.ws,{bidirectional:!1});this.term.loadAddon(c),this.term.onData((function(e){a.ws&&1===a.ws.readyState&&a.ws.send(e)})),this.term.attachCustomKeyEventHandler((function(e){return!(["F5","F11","F12"].indexOf(e.key)>-1)&&(e.ctrlKey&&"v"===e.key||e.ctrlKey&&"c"===e.key&&a.term.hasSelection()?(document.execCommand("copy"),!1):void 0)}));var l="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";s.addEventListener(l,(function(t){if(t.ctrlKey){t.preventDefault(),t.deltaY<0?a.term.setOption("fontSize",++e.fontSize):a.term.setOption("fontSize",--e.fontSize);try{o.fit()}catch(t){}null!==a.ws&&1===a.ws.readyState&&a.ws.send("resize:".concat(a.term.rows,":").concat(a.term.cols))}})),window.addEventListener("resize",(function(){try{o.fit()}catch(e){}null!==a.ws&&1===a.ws.readyState&&a.ws.send("resize:".concat(a.term.rows,":").concat(a.term.cols))}))}else console.error("Terminal container #xterm-container not found.")},connected:function(){var e=this;return Object($.a)(Object(O.a)().m((function t(){var s,n,o,a;return Object(O.a)().w((function(t){for(;;)switch(t.n){case 0:return s=e.$store.state.sshInfo,e.ssh=Object.assign({},s),t.n=1,K(e.$store.getters.sshReq);case 1:if("success"===(n=t.v).Msg){t.n=2;break}return t.a(2);case 2:e.savePass=n.Data.savePass;case 3:document.title=s.hostname,null===(o=e.$store.state.sshList)?o=e.savePass?'[{"hostname": "'.concat(s.hostname,'", "username": "').concat(s.username,'", "port":').concat(s.port,', "logintype":').concat(s.logintype,', "password":"').concat(s.password,'"}]'):'[{"hostname": "'.concat(s.hostname,'", "username": "').concat(s.username,'", "port":').concat(s.port,',  "logintype":').concat(s.logintype,"}]"):((a=JSON.parse(window.atob(o))).forEach((function(e,t){e.hostname===s.hostname&&a.splice(t,1)})),a.push({hostname:s.hostname,username:s.username,port:s.port,logintype:s.logintype}),e.savePass&&(a[a.length-1].password=s.password),o=JSON.stringify(a)),e.$store.commit("SET_LIST",window.btoa(o));case 4:return t.a(2)}}),t)})))()},close:function(){null!==this.ws&&(this.ws.close(),this.resetClose=!0),null!==this.term&&this.term.dispose()}},beforeDestroy:function(){this.close()}}),E=(s("2897"),{components:{Terminal:Object(i.a)(R,(function(){var e=this._self._c;return e("div",{staticClass:"terminal-page-wrapper"},[e("div",{staticClass:"terminal-page-container"},[this._m(0),e("div",{staticClass:"file-tree",class:{"is-visible":this.isSftpVisible}},[e("FileList")],1)]),e("div",{staticClass:"terminal-footer"},[e("span",[this._v("WebSSH Console | Powered by eooce")]),this._m(1),e("button",{staticClass:"sftp-toggle-btn",attrs:{title:"文件管理"},on:{click:this.toggleSftpPanel}},[e("i",{staticClass:"fas fa-folder-open"})])])])}),[function(){var e=this._self._c;return e("div",{staticClass:"terminal-area"},[e("div",{attrs:{id:"xterm-container"}})])},function(){var e=this._self._c;return e("a",{staticClass:"github-link",attrs:{href:"https://github.com/eooce/webssh",target:"_blank",title:"GitHub"}},[e("i",{staticClass:"fab fa-github"})])}],!1,null,"0c044472",null).exports},beforeCreate:function(){var e=this.$route.query,t=e.hostname,s=e.port,n=e.username,o=e.password,a=e.command,r=e.privateKey,i=e.passphrase,c=e.useKey;if(t&&(t=decodeURIComponent(t)),n&&(n=decodeURIComponent(n)),o)try{o=atob(o)}catch(e){o=decodeURIComponent(o)}if(a&&(a=decodeURIComponent(a)),r&&(r=decodeURIComponent(r)),i&&(i=decodeURIComponent(i)),c){var l=sessionStorage.getItem("sshInfo");if(l){var u=JSON.parse(l);t=u.hostname,s=u.port,n=u.username,o=u.password,a=u.command,r=u.privateKey,i=u.passphrase}}else if(!t||!n||!o&&!r){var h=sessionStorage.getItem("sshInfo");if(h){var p=JSON.parse(h);t=p.hostname,s=p.port,n=p.username,o=p.password,a=p.command,r=p.privateKey,i=p.passphrase}}t&&n&&(o||r)&&this.$store.commit("SET_SSH",{hostname:t,port:Number(s)||22,username:n,password:o,command:a,privateKey:r,passphrase:i})}}),z=(s("d75a"),Object(i.a)(E,(function(){var e=this._self._c;return e("div",{staticClass:"terminal-page"},[e("Terminal")],1)}),[],!1,null,"4edf7ad7",null).exports);n.default.use(_.a);var M=new _.a({mode:"history",routes:[{path:"/",component:L},{path:"/terminal",component:z}]});s("abb2");function A(e){"dark"===e?document.body.classList.add("dark-theme"):document.body.classList.remove("dark-theme"),localStorage.setItem("theme",e)}n.default.use(a),n.default.config.productionTip=!1,new n.default({el:"#app",i18n:I,store:C,router:M,render:function(e){return e(c)}}),A(localStorage.getItem("theme")||"light"),window.setTheme=A},"571b":function(e,t,s){},ad04:function(e,t,s){},b20f:function(e,t,s){},d75a:function(e,t,s){"use strict";s("fa09")},fa09:function(e,t,s){},feba:function(e,t,s){"use strict";s("571b")}});
//# sourceMappingURL=app-d0ae3f07.e7cc8ce1.js.map